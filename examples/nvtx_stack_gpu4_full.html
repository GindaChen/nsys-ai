<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NVTX Stack Trace — GPU 4 — NVIDIA H200 (0000:ab:00.0), 132 SMs, 150GB</title>
<style>
  :root {
    --bg: #0d1117; --surface: #161b22; --border: #30363d;
    --text: #e6edf3; --text-dim: #8b949e; --accent: #58a6ff;
    --nvtx: #1f6feb; --kernel: #238636; --kernel-bg: #0d3117;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: 'SF Mono', 'Cascadia Code', 'Fira Code', monospace;
         font-size: 13px; background: var(--bg); color: var(--text);
         padding: 20px; line-height: 1.6; }
  h1 { font-size: 16px; color: var(--accent); margin-bottom: 4px; font-weight: 600; }
  .subtitle { color: var(--text-dim); font-size: 12px; margin-bottom: 16px; }
  .tree { }
  .node { margin-left: 20px; border-left: 1px solid var(--border); padding-left: 12px; }
  .node-header {
    display: flex; align-items: baseline; gap: 8px; padding: 2px 0;
    cursor: pointer; user-select: none;
  }
  .node-header:hover { background: var(--surface); border-radius: 3px; }
  .toggle { width: 16px; text-align: center; color: var(--text-dim); flex-shrink: 0; }
  .icon { flex-shrink: 0; }
  .name { color: var(--text); }
  .nvtx .name { color: var(--accent); font-weight: 500; }
  .kernel .name { color: #7ee787; }
  .dur { color: var(--text-dim); font-size: 11px; white-space: nowrap; }
  .stream { color: #d2a8ff; font-size: 11px; }
  .children { }
  .children.collapsed { display: none; }
  .stats {
    display: flex; gap: 24px; margin-bottom: 16px; padding: 10px 14px;
    background: var(--surface); border: 1px solid var(--border); border-radius: 6px;
    font-size: 12px;
  }
  .stats span { color: var(--text-dim); }
  .stats strong { color: var(--text); }
  .controls { margin-bottom: 12px; }
  .controls button {
    background: var(--surface); border: 1px solid var(--border); color: var(--text);
    padding: 4px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;
    font-family: inherit; margin-right: 6px;
  }
  .controls button:hover { border-color: var(--accent); }
  .search { margin-bottom: 12px; }
  .search input {
    background: var(--surface); border: 1px solid var(--border); color: var(--text);
    padding: 6px 10px; border-radius: 4px; width: 300px; font-size: 12px;
    font-family: inherit;
  }
  .highlight { background: #463818; border-radius: 2px; }
</style>
</head>
<body>
<h1>NVTX Stack Trace</h1>
<div class="subtitle">GPU 4 — NVIDIA H200 (0000:ab:00.0), 132 SMs, 150GB &nbsp;|&nbsp; Window: 39.0s – 42.0s</div>

<div class="stats" id="stats"></div>

<div class="controls">
  <button onclick="expandAll()">Expand All</button>
  <button onclick="collapseAll()">Collapse All</button>
  <button onclick="expandToDepth(2)">Depth 2</button>
  <button onclick="expandToDepth(4)">Depth 4</button>
</div>
<div class="search">
  <input type="text" id="search" placeholder="Filter by name..." oninput="filterTree(this.value)">
</div>

<div class="tree" id="tree"></div>

<script>
const DATA = [{"name": "sample_0(repeat=5)", "type": "nvtx", "duration_ms": 4090.484, "children": [{"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.003, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "indexSelectLargeIndex", "type": "kernel", "duration_ms": 6.455, "stream": 21}, {"name": "elementwise_kernel", "type": "kernel", "duration_ms": 2.524, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.895, "stream": 56}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "elementwise_kernel_with_index", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.013, "stream": 21}, {"name": "CatArrayBatchedCopy_aligned16_contig", "type": "kernel", "duration_ms": 0.015, "stream": 21}, {"name": "TransformerLayer._forward_attention.self_attention", "type": "nvtx", "duration_ms": 43.53, "children": [{"name": "TELayerNormColumnParallelLinear forward", "type": "nvtx", "duration_ms": 7.69, "children": [{"name": "transformer_engine._LayerNormLinear.forward.norm", "type": "nvtx", "duration_ms": 0.138, "children": [{"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.138, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.138, "stream": 21}]}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm_input_cast_comm", "type": "nvtx", "duration_ms": 5.379, "children": [{"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.379, "stream": 56}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm", "type": "nvtx", "duration_ms": 2.124, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 2.124, "children": [{"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 2.124, "stream": 21}]}]}]}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.334, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.156, "stream": 21}, {"name": "TEDotProductAttention.forward", "type": "nvtx", "duration_ms": 26.303, "children": [{"name": "TEDotProductAttention.forward.core_attn_out", "type": "nvtx", "duration_ms": 26.303, "children": [{"name": "PerDocCPAttention forward", "type": "nvtx", "duration_ms": 26.303, "children": [{"name": "te.DotProductAttention.inference", "type": "nvtx", "duration_ms": 0.079, "children": [{"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.079, "stream": 21}]}, {"name": "te.DotProductAttention.flash_attention.forward", "type": "nvtx", "duration_ms": 25.985, "children": [{"name": "te.FlashAttention.forward", "type": "nvtx", "duration_ms": 25.985, "children": [{"name": "te.FlashAttention.run_attention", "type": "nvtx", "duration_ms": 25.985, "children": [{"name": "flash_fwd_kernel", "type": "kernel", "duration_ms": 25.985, "stream": 21}]}]}]}]}]}]}, {"name": "TERowParallelLinear forward", "type": "nvtx", "duration_ms": 7.031, "children": [{"name": "transformer_engine._Linear.forward.gemm", "type": "nvtx", "duration_ms": 1.662, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 1.662, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 1.662, "stream": 21}]}]}, {"name": "transformer_engine._Linear.forward.row_parallel_comm", "type": "nvtx", "duration_ms": 5.364, "children": [{"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.364, "stream": 56}]}]}]}, {"name": "TransformerLayer._forward_attention.self_attn_bda", "type": "nvtx", "duration_ms": 0.185, "children": [{"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.185, "stream": 21}]}, {"name": "TransformerLayer._forward_mlp.mlp", "type": "nvtx", "duration_ms": 26.603, "children": [{"name": "TELayerNormColumnParallelLinear forward", "type": "nvtx", "duration_ms": 15.571, "children": [{"name": "transformer_engine._LayerNormLinear.forward.norm", "type": "nvtx", "duration_ms": 0.136, "children": [{"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.136, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.136, "stream": 21}]}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm_input_cast_comm", "type": "nvtx", "duration_ms": 5.425, "children": [{"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.425, "stream": 56}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm", "type": "nvtx", "duration_ms": 9.99, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 9.99, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 9.99, "stream": 21}]}]}]}, {"name": "triton_poi_fused_mul_silu_0", "type": "kernel", "duration_ms": 0.638, "stream": 21}, {"name": "TERowParallelLinear forward", "type": "nvtx", "duration_ms": 10.385, "children": [{"name": "transformer_engine._Linear.forward.gemm", "type": "nvtx", "duration_ms": 4.995, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 4.995, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 4.995, "stream": 21}]}]}, {"name": "transformer_engine._Linear.forward.row_parallel_comm", "type": "nvtx", "duration_ms": 5.385, "children": [{"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.385, "stream": 56}]}]}]}, {"name": "TransformerLayer._forward_mlp.mlp_bda", "type": "nvtx", "duration_ms": 0.184, "children": [{"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.184, "stream": 21}]}, {"name": "TransformerLayer._forward_attention.self_attention", "type": "nvtx", "duration_ms": 46.15, "children": [{"name": "TELayerNormColumnParallelLinear forward", "type": "nvtx", "duration_ms": 7.714, "children": [{"name": "transformer_engine._LayerNormLinear.forward.norm", "type": "nvtx", "duration_ms": 0.142, "children": [{"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.142, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.142, "stream": 21}]}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm_input_cast_comm", "type": "nvtx", "duration_ms": 5.414, "children": [{"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.414, "stream": 56}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm", "type": "nvtx", "duration_ms": 2.142, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 2.142, "children": [{"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 2.142, "stream": 21}]}]}]}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.338, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.159, "stream": 21}, {"name": "TEDotProductAttention.forward", "type": "nvtx", "duration_ms": 27.1, "children": [{"name": "TEDotProductAttention.forward.core_attn_out", "type": "nvtx", "duration_ms": 27.1, "children": [{"name": "PerDocCPAttention forward", "type": "nvtx", "duration_ms": 27.1, "children": [{"name": "te.DotProductAttention.inference", "type": "nvtx", "duration_ms": 0.08, "children": [{"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.08, "stream": 21}]}, {"name": "te.DotProductAttention.flash_attention.forward", "type": "nvtx", "duration_ms": 26.828, "children": [{"name": "te.FlashAttention.forward", "type": "nvtx", "duration_ms": 26.828, "children": [{"name": "te.FlashAttention.run_attention", "type": "nvtx", "duration_ms": 26.828, "children": [{"name": "flash_fwd_kernel", "type": "kernel", "duration_ms": 26.828, "stream": 21}]}]}]}]}]}]}, {"name": "TERowParallelLinear forward", "type": "nvtx", "duration_ms": 8.823, "children": [{"name": "transformer_engine._Linear.forward.gemm", "type": "nvtx", "duration_ms": 1.666, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 1.666, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 1.666, "stream": 21}]}]}, {"name": "transformer_engine._Linear.forward.row_parallel_comm", "type": "nvtx", "duration_ms": 7.155, "children": [{"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 7.155, "stream": 56}]}]}]}, {"name": "TransformerLayer._forward_attention.self_attn_bda", "type": "nvtx", "duration_ms": 0.185, "children": [{"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.185, "stream": 21}]}, {"name": "TransformerLayer._forward_mlp.mlp", "type": "nvtx", "duration_ms": 26.689, "children": [{"name": "TELayerNormColumnParallelLinear forward", "type": "nvtx", "duration_ms": 15.599, "children": [{"name": "transformer_engine._LayerNormLinear.forward.norm", "type": "nvtx", "duration_ms": 0.141, "children": [{"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.141, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.141, "stream": 21}]}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm_input_cast_comm", "type": "nvtx", "duration_ms": 5.425, "children": [{"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.425, "stream": 56}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm", "type": "nvtx", "duration_ms": 10.013, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 10.013, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 10.013, "stream": 21}]}]}]}, {"name": "triton_poi_fused_mul_silu_0", "type": "kernel", "duration_ms": 0.64, "stream": 21}, {"name": "TERowParallelLinear forward", "type": "nvtx", "duration_ms": 10.443, "children": [{"name": "transformer_engine._Linear.forward.gemm", "type": "nvtx", "duration_ms": 4.997, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 4.997, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 4.997, "stream": 21}]}]}, {"name": "transformer_engine._Linear.forward.row_parallel_comm", "type": "nvtx", "duration_ms": 5.444, "children": [{"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.444, "stream": 56}]}]}]}, {"name": "TransformerLayer._forward_mlp.mlp_bda", "type": "nvtx", "duration_ms": 0.186, "children": [{"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.186, "stream": 21}]}, {"name": "TransformerLayer._forward_attention.self_attention", "type": "nvtx", "duration_ms": 47.051, "children": [{"name": "TELayerNormColumnParallelLinear forward", "type": "nvtx", "duration_ms": 7.726, "children": [{"name": "transformer_engine._LayerNormLinear.forward.norm", "type": "nvtx", "duration_ms": 0.138, "children": [{"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.138, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.138, "stream": 21}]}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm_input_cast_comm", "type": "nvtx", "duration_ms": 5.429, "children": [{"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.429, "stream": 56}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm", "type": "nvtx", "duration_ms": 2.141, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 2.141, "children": [{"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 2.141, "stream": 21}]}]}]}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.344, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.16, "stream": 21}, {"name": "TEDotProductAttention.forward", "type": "nvtx", "duration_ms": 26.321, "children": [{"name": "TEDotProductAttention.forward.core_attn_out", "type": "nvtx", "duration_ms": 26.321, "children": [{"name": "PerDocCPAttention forward", "type": "nvtx", "duration_ms": 26.321, "children": [{"name": "te.DotProductAttention.inference", "type": "nvtx", "duration_ms": 0.08, "children": [{"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.08, "stream": 21}]}, {"name": "te.DotProductAttention.flash_attention.forward", "type": "nvtx", "duration_ms": 26.066, "children": [{"name": "te.FlashAttention.forward", "type": "nvtx", "duration_ms": 26.066, "children": [{"name": "te.FlashAttention.run_attention", "type": "nvtx", "duration_ms": 26.066, "children": [{"name": "flash_fwd_kernel", "type": "kernel", "duration_ms": 26.066, "stream": 21}]}]}]}]}]}]}, {"name": "TERowParallelLinear forward", "type": "nvtx", "duration_ms": 10.483, "children": [{"name": "transformer_engine._Linear.forward.gemm", "type": "nvtx", "duration_ms": 1.655, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 1.655, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 1.655, "stream": 21}]}]}, {"name": "transformer_engine._Linear.forward.row_parallel_comm", "type": "nvtx", "duration_ms": 8.827, "children": [{"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 8.827, "stream": 56}]}]}]}, {"name": "TransformerLayer._forward_attention.self_attn_bda", "type": "nvtx", "duration_ms": 0.185, "children": [{"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.185, "stream": 21}]}, {"name": "TransformerLayer._forward_mlp.mlp", "type": "nvtx", "duration_ms": 26.706, "children": [{"name": "TELayerNormColumnParallelLinear forward", "type": "nvtx", "duration_ms": 15.547, "children": [{"name": "transformer_engine._LayerNormLinear.forward.norm", "type": "nvtx", "duration_ms": 0.142, "children": [{"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.142, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.142, "stream": 21}]}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm_input_cast_comm", "type": "nvtx", "duration_ms": 5.373, "children": [{"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.373, "stream": 56}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm", "type": "nvtx", "duration_ms": 10.012, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 10.012, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 10.012, "stream": 21}]}]}]}, {"name": "triton_poi_fused_mul_silu_0", "type": "kernel", "duration_ms": 0.64, "stream": 21}, {"name": "TERowParallelLinear forward", "type": "nvtx", "duration_ms": 10.511, "children": [{"name": "transformer_engine._Linear.forward.gemm", "type": "nvtx", "duration_ms": 5.003, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 5.003, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 5.003, "stream": 21}]}]}, {"name": "transformer_engine._Linear.forward.row_parallel_comm", "type": "nvtx", "duration_ms": 5.506, "children": [{"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.506, "stream": 56}]}]}]}, {"name": "TransformerLayer._forward_mlp.mlp_bda", "type": "nvtx", "duration_ms": 0.185, "children": [{"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.185, "stream": 21}]}, {"name": "TransformerLayer._forward_attention.self_attention", "type": "nvtx", "duration_ms": 47.145, "children": [{"name": "TELayerNormColumnParallelLinear forward", "type": "nvtx", "duration_ms": 7.757, "children": [{"name": "transformer_engine._LayerNormLinear.forward.norm", "type": "nvtx", "duration_ms": 0.143, "children": [{"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.143, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.143, "stream": 21}]}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm_input_cast_comm", "type": "nvtx", "duration_ms": 5.454, "children": [{"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.454, "stream": 56}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm", "type": "nvtx", "duration_ms": 2.144, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 2.144, "children": [{"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 2.144, "stream": 21}]}]}]}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.345, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.163, "stream": 21}, {"name": "TEDotProductAttention.forward", "type": "nvtx", "duration_ms": 26.649, "children": [{"name": "TEDotProductAttention.forward.core_attn_out", "type": "nvtx", "duration_ms": 26.649, "children": [{"name": "PerDocCPAttention forward", "type": "nvtx", "duration_ms": 26.649, "children": [{"name": "te.DotProductAttention.inference", "type": "nvtx", "duration_ms": 0.08, "children": [{"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.08, "stream": 21}]}, {"name": "te.DotProductAttention.flash_attention.forward", "type": "nvtx", "duration_ms": 26.411, "children": [{"name": "te.FlashAttention.forward", "type": "nvtx", "duration_ms": 26.411, "children": [{"name": "te.FlashAttention.run_attention", "type": "nvtx", "duration_ms": 26.411, "children": [{"name": "flash_fwd_kernel", "type": "kernel", "duration_ms": 26.411, "stream": 21}]}]}]}]}]}]}, {"name": "TERowParallelLinear forward", "type": "nvtx", "duration_ms": 10.214, "children": [{"name": "transformer_engine._Linear.forward.gemm", "type": "nvtx", "duration_ms": 1.667, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 1.667, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 1.667, "stream": 21}]}]}, {"name": "transformer_engine._Linear.forward.row_parallel_comm", "type": "nvtx", "duration_ms": 8.544, "children": [{"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 8.544, "stream": 56}]}]}]}, {"name": "TransformerLayer._forward_attention.self_attn_bda", "type": "nvtx", "duration_ms": 0.186, "children": [{"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.186, "stream": 21}]}, {"name": "TransformerLayer._forward_mlp.mlp", "type": "nvtx", "duration_ms": 26.713, "children": [{"name": "TELayerNormColumnParallelLinear forward", "type": "nvtx", "duration_ms": 15.563, "children": [{"name": "transformer_engine._LayerNormLinear.forward.norm", "type": "nvtx", "duration_ms": 0.142, "children": [{"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.142, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.142, "stream": 21}]}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm_input_cast_comm", "type": "nvtx", "duration_ms": 5.396, "children": [{"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.396, "stream": 56}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm", "type": "nvtx", "duration_ms": 10.003, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 10.003, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 10.003, "stream": 21}]}]}]}, {"name": "triton_poi_fused_mul_silu_0", "type": "kernel", "duration_ms": 0.643, "stream": 21}, {"name": "TERowParallelLinear forward", "type": "nvtx", "duration_ms": 10.5, "children": [{"name": "transformer_engine._Linear.forward.gemm", "type": "nvtx", "duration_ms": 4.993, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 4.993, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 4.993, "stream": 21}]}]}, {"name": "transformer_engine._Linear.forward.row_parallel_comm", "type": "nvtx", "duration_ms": 5.503, "children": [{"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.503, "stream": 56}]}]}]}, {"name": "TransformerLayer._forward_mlp.mlp_bda", "type": "nvtx", "duration_ms": 0.184, "children": [{"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.184, "stream": 21}]}, {"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.14, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.14, "stream": 21}]}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.453, "stream": 56}, {"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 43.657, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 1.96, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 1.956, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 1.951, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 1.951, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 1.989, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.14, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.141, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.054, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.989, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.988, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.986, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.986, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.986, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.989, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.988, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.987, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.988, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.989, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.989, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.988, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.989, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.987, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.988, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.988, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.495, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.483, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.487, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.486, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.486, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.487, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.486, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.484, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "nvte_multi_tensor_l2norm_cuda", "type": "nvtx", "duration_ms": 0.162, "children": [{"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.031, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.024, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.025, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.025, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.024, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.021, "stream": 21}, {"name": "cleanup", "type": "kernel", "duration_ms": 0.002, "stream": 21}]}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "ncclDevKernel_AllReduce_Sum_f32_TREE_LL", "type": "kernel", "duration_ms": 0.115, "stream": 60}, {"name": "nvte_multi_tensor_scale_cuda", "type": "nvtx", "duration_ms": 0.274, "children": [{"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.043, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.046, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.046, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.046, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.046, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.038, "stream": 21}]}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.004, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.003, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.012, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.027, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.022, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.018, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.058, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.039, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.005, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.011, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.009, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.004, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.01, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.007, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.011, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.027, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.021, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.018, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.057, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.04, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.005, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.011, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.009, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.004, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.01, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.007, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.078, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.248, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.129, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "ncclDevKernel_AllReduce_Sum_f32_TREE_LL", "type": "kernel", "duration_ms": 1.316, "stream": 60}, {"name": "nvte_multi_tensor_adam_cuda", "type": "nvtx", "duration_ms": 0.996, "children": [{"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.168, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.174, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.175, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.174, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.173, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.123, "stream": 21}]}, {"name": "nvte_multi_tensor_adam_cuda", "type": "nvtx", "duration_ms": 0.006, "children": [{"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.006, "stream": 21}]}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.014, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.023, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.007, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.005, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.012, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.023, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.007, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.005, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.091, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.258, "stream": 52}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "indexSelectLargeIndex", "type": "kernel", "duration_ms": 6.5, "stream": 21}, {"name": "elementwise_kernel", "type": "kernel", "duration_ms": 2.522, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 6.183, "stream": 56}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "elementwise_kernel_with_index", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.013, "stream": 21}, {"name": "CatArrayBatchedCopy_aligned16_contig", "type": "kernel", "duration_ms": 0.015, "stream": 21}, {"name": "TransformerLayer._forward_attention.self_attention", "type": "nvtx", "duration_ms": 43.738, "children": [{"name": "TELayerNormColumnParallelLinear forward", "type": "nvtx", "duration_ms": 7.749, "children": [{"name": "transformer_engine._LayerNormLinear.forward.norm", "type": "nvtx", "duration_ms": 0.141, "children": [{"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.141, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.141, "stream": 21}]}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm_input_cast_comm", "type": "nvtx", "duration_ms": 5.444, "children": [{"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.444, "stream": 56}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm", "type": "nvtx", "duration_ms": 2.149, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 2.149, "children": [{"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 2.149, "stream": 21}]}]}]}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.338, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.16, "stream": 21}, {"name": "TEDotProductAttention.forward", "type": "nvtx", "duration_ms": 26.194, "children": [{"name": "TEDotProductAttention.forward.core_attn_out", "type": "nvtx", "duration_ms": 26.194, "children": [{"name": "PerDocCPAttention forward", "type": "nvtx", "duration_ms": 26.194, "children": [{"name": "te.DotProductAttention.inference", "type": "nvtx", "duration_ms": 0.079, "children": [{"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.079, "stream": 21}]}, {"name": "te.DotProductAttention.flash_attention.forward", "type": "nvtx", "duration_ms": 25.95, "children": [{"name": "te.FlashAttention.forward", "type": "nvtx", "duration_ms": 25.95, "children": [{"name": "te.FlashAttention.run_attention", "type": "nvtx", "duration_ms": 25.95, "children": [{"name": "flash_fwd_kernel", "type": "kernel", "duration_ms": 25.95, "stream": 21}]}]}]}]}]}]}, {"name": "TERowParallelLinear forward", "type": "nvtx", "duration_ms": 7.284, "children": [{"name": "transformer_engine._Linear.forward.gemm", "type": "nvtx", "duration_ms": 1.67, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 1.67, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 1.67, "stream": 21}]}]}, {"name": "transformer_engine._Linear.forward.row_parallel_comm", "type": "nvtx", "duration_ms": 5.608, "children": [{"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.608, "stream": 56}]}]}]}, {"name": "TransformerLayer._forward_attention.self_attn_bda", "type": "nvtx", "duration_ms": 0.185, "children": [{"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.185, "stream": 21}]}, {"name": "TransformerLayer._forward_mlp.mlp", "type": "nvtx", "duration_ms": 26.708, "children": [{"name": "TELayerNormColumnParallelLinear forward", "type": "nvtx", "duration_ms": 15.581, "children": [{"name": "transformer_engine._LayerNormLinear.forward.norm", "type": "nvtx", "duration_ms": 0.139, "children": [{"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.139, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.139, "stream": 21}]}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm_input_cast_comm", "type": "nvtx", "duration_ms": 5.382, "children": [{"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.382, "stream": 56}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm", "type": "nvtx", "duration_ms": 10.04, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 10.04, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 10.04, "stream": 21}]}]}]}, {"name": "triton_poi_fused_mul_silu_0", "type": "kernel", "duration_ms": 0.64, "stream": 21}, {"name": "TERowParallelLinear forward", "type": "nvtx", "duration_ms": 10.478, "children": [{"name": "transformer_engine._Linear.forward.gemm", "type": "nvtx", "duration_ms": 5.006, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 5.006, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 5.006, "stream": 21}]}]}, {"name": "transformer_engine._Linear.forward.row_parallel_comm", "type": "nvtx", "duration_ms": 5.47, "children": [{"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.47, "stream": 56}]}]}]}, {"name": "TransformerLayer._forward_mlp.mlp_bda", "type": "nvtx", "duration_ms": 0.186, "children": [{"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.186, "stream": 21}]}, {"name": "TransformerLayer._forward_attention.self_attention", "type": "nvtx", "duration_ms": 47.231, "children": [{"name": "TELayerNormColumnParallelLinear forward", "type": "nvtx", "duration_ms": 7.795, "children": [{"name": "transformer_engine._LayerNormLinear.forward.norm", "type": "nvtx", "duration_ms": 0.141, "children": [{"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.141, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.141, "stream": 21}]}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm_input_cast_comm", "type": "nvtx", "duration_ms": 5.482, "children": [{"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.482, "stream": 56}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm", "type": "nvtx", "duration_ms": 2.154, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 2.154, "children": [{"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 2.154, "stream": 21}]}]}]}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.36, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.171, "stream": 21}, {"name": "TEDotProductAttention.forward", "type": "nvtx", "duration_ms": 27.993, "children": [{"name": "TEDotProductAttention.forward.core_attn_out", "type": "nvtx", "duration_ms": 27.993, "children": [{"name": "PerDocCPAttention forward", "type": "nvtx", "duration_ms": 27.993, "children": [{"name": "te.DotProductAttention.inference", "type": "nvtx", "duration_ms": 0.082, "children": [{"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.082, "stream": 21}]}, {"name": "te.DotProductAttention.flash_attention.forward", "type": "nvtx", "duration_ms": 27.74, "children": [{"name": "te.FlashAttention.forward", "type": "nvtx", "duration_ms": 27.74, "children": [{"name": "te.FlashAttention.run_attention", "type": "nvtx", "duration_ms": 27.74, "children": [{"name": "flash_fwd_kernel", "type": "kernel", "duration_ms": 27.74, "stream": 21}]}]}]}]}]}]}, {"name": "TERowParallelLinear forward", "type": "nvtx", "duration_ms": 8.898, "children": [{"name": "transformer_engine._Linear.forward.gemm", "type": "nvtx", "duration_ms": 1.674, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 1.674, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 1.674, "stream": 21}]}]}, {"name": "transformer_engine._Linear.forward.row_parallel_comm", "type": "nvtx", "duration_ms": 7.222, "children": [{"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 7.222, "stream": 56}]}]}]}, {"name": "TransformerLayer._forward_attention.self_attn_bda", "type": "nvtx", "duration_ms": 0.185, "children": [{"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.185, "stream": 21}]}, {"name": "TransformerLayer._forward_mlp.mlp", "type": "nvtx", "duration_ms": 26.719, "children": [{"name": "TELayerNormColumnParallelLinear forward", "type": "nvtx", "duration_ms": 15.594, "children": [{"name": "transformer_engine._LayerNormLinear.forward.norm", "type": "nvtx", "duration_ms": 0.141, "children": [{"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.141, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.141, "stream": 21}]}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm_input_cast_comm", "type": "nvtx", "duration_ms": 5.406, "children": [{"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.406, "stream": 56}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm", "type": "nvtx", "duration_ms": 10.028, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 10.028, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 10.028, "stream": 21}]}]}]}, {"name": "triton_poi_fused_mul_silu_0", "type": "kernel", "duration_ms": 0.639, "stream": 21}, {"name": "TERowParallelLinear forward", "type": "nvtx", "duration_ms": 10.479, "children": [{"name": "transformer_engine._Linear.forward.gemm", "type": "nvtx", "duration_ms": 5.011, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 5.011, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 5.011, "stream": 21}]}]}, {"name": "transformer_engine._Linear.forward.row_parallel_comm", "type": "nvtx", "duration_ms": 5.463, "children": [{"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.463, "stream": 56}]}]}]}, {"name": "TransformerLayer._forward_mlp.mlp_bda", "type": "nvtx", "duration_ms": 0.186, "children": [{"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.186, "stream": 21}]}, {"name": "TransformerLayer._forward_attention.self_attention", "type": "nvtx", "duration_ms": 46.609, "children": [{"name": "TELayerNormColumnParallelLinear forward", "type": "nvtx", "duration_ms": 7.728, "children": [{"name": "transformer_engine._LayerNormLinear.forward.norm", "type": "nvtx", "duration_ms": 0.137, "children": [{"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.137, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.137, "stream": 21}]}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm_input_cast_comm", "type": "nvtx", "duration_ms": 5.413, "children": [{"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.413, "stream": 56}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm", "type": "nvtx", "duration_ms": 2.16, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 2.16, "children": [{"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 2.16, "stream": 21}]}]}]}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.401, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.192, "stream": 21}, {"name": "TEDotProductAttention.forward", "type": "nvtx", "duration_ms": 29.234, "children": [{"name": "TEDotProductAttention.forward.core_attn_out", "type": "nvtx", "duration_ms": 29.234, "children": [{"name": "PerDocCPAttention forward", "type": "nvtx", "duration_ms": 29.234, "children": [{"name": "te.DotProductAttention.inference", "type": "nvtx", "duration_ms": 0.085, "children": [{"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.085, "stream": 21}]}, {"name": "te.DotProductAttention.flash_attention.forward", "type": "nvtx", "duration_ms": 28.976, "children": [{"name": "te.FlashAttention.forward", "type": "nvtx", "duration_ms": 28.976, "children": [{"name": "te.FlashAttention.run_attention", "type": "nvtx", "duration_ms": 28.976, "children": [{"name": "flash_fwd_kernel", "type": "kernel", "duration_ms": 28.976, "stream": 21}]}]}]}]}]}]}, {"name": "TERowParallelLinear forward", "type": "nvtx", "duration_ms": 7.035, "children": [{"name": "transformer_engine._Linear.forward.gemm", "type": "nvtx", "duration_ms": 1.688, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 1.688, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 1.688, "stream": 21}]}]}, {"name": "transformer_engine._Linear.forward.row_parallel_comm", "type": "nvtx", "duration_ms": 5.344, "children": [{"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.344, "stream": 56}]}]}]}, {"name": "TransformerLayer._forward_attention.self_attn_bda", "type": "nvtx", "duration_ms": 0.184, "children": [{"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.184, "stream": 21}]}, {"name": "TransformerLayer._forward_mlp.mlp", "type": "nvtx", "duration_ms": 26.684, "children": [{"name": "TELayerNormColumnParallelLinear forward", "type": "nvtx", "duration_ms": 15.575, "children": [{"name": "transformer_engine._LayerNormLinear.forward.norm", "type": "nvtx", "duration_ms": 0.142, "children": [{"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.142, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.142, "stream": 21}]}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm_input_cast_comm", "type": "nvtx", "duration_ms": 5.367, "children": [{"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.367, "stream": 56}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm", "type": "nvtx", "duration_ms": 10.049, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 10.049, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 10.049, "stream": 21}]}]}]}, {"name": "triton_poi_fused_mul_silu_0", "type": "kernel", "duration_ms": 0.64, "stream": 21}, {"name": "TERowParallelLinear forward", "type": "nvtx", "duration_ms": 10.462, "children": [{"name": "transformer_engine._Linear.forward.gemm", "type": "nvtx", "duration_ms": 5.018, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 5.018, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 5.018, "stream": 21}]}]}, {"name": "transformer_engine._Linear.forward.row_parallel_comm", "type": "nvtx", "duration_ms": 5.439, "children": [{"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.439, "stream": 56}]}]}]}, {"name": "TransformerLayer._forward_mlp.mlp_bda", "type": "nvtx", "duration_ms": 0.186, "children": [{"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.186, "stream": 21}]}, {"name": "TransformerLayer._forward_attention.self_attention", "type": "nvtx", "duration_ms": 48.097, "children": [{"name": "TELayerNormColumnParallelLinear forward", "type": "nvtx", "duration_ms": 7.748, "children": [{"name": "transformer_engine._LayerNormLinear.forward.norm", "type": "nvtx", "duration_ms": 0.139, "children": [{"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.139, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.139, "stream": 21}]}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm_input_cast_comm", "type": "nvtx", "duration_ms": 5.439, "children": [{"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.439, "stream": 56}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm", "type": "nvtx", "duration_ms": 2.152, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 2.152, "children": [{"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 2.152, "stream": 21}]}]}]}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.355, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.168, "stream": 21}, {"name": "TEDotProductAttention.forward", "type": "nvtx", "duration_ms": 27.991, "children": [{"name": "TEDotProductAttention.forward.core_attn_out", "type": "nvtx", "duration_ms": 27.991, "children": [{"name": "PerDocCPAttention forward", "type": "nvtx", "duration_ms": 27.991, "children": [{"name": "te.DotProductAttention.inference", "type": "nvtx", "duration_ms": 0.081, "children": [{"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.081, "stream": 21}]}, {"name": "te.DotProductAttention.flash_attention.forward", "type": "nvtx", "duration_ms": 27.56, "children": [{"name": "te.FlashAttention.forward", "type": "nvtx", "duration_ms": 27.56, "children": [{"name": "te.FlashAttention.run_attention", "type": "nvtx", "duration_ms": 27.56, "children": [{"name": "flash_fwd_kernel", "type": "kernel", "duration_ms": 27.56, "stream": 21}]}]}]}]}]}]}, {"name": "TERowParallelLinear forward", "type": "nvtx", "duration_ms": 9.817, "children": [{"name": "transformer_engine._Linear.forward.gemm", "type": "nvtx", "duration_ms": 1.672, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 1.672, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 1.672, "stream": 21}]}]}, {"name": "transformer_engine._Linear.forward.row_parallel_comm", "type": "nvtx", "duration_ms": 8.14, "children": [{"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 8.14, "stream": 56}]}]}]}, {"name": "TransformerLayer._forward_attention.self_attn_bda", "type": "nvtx", "duration_ms": 0.185, "children": [{"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.185, "stream": 21}]}, {"name": "TransformerLayer._forward_mlp.mlp", "type": "nvtx", "duration_ms": 26.692, "children": [{"name": "TELayerNormColumnParallelLinear forward", "type": "nvtx", "duration_ms": 15.6, "children": [{"name": "transformer_engine._LayerNormLinear.forward.norm", "type": "nvtx", "duration_ms": 0.143, "children": [{"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.143, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.143, "stream": 21}]}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm_input_cast_comm", "type": "nvtx", "duration_ms": 5.387, "children": [{"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.387, "stream": 56}]}, {"name": "transformer_engine._LayerNormLinear.forward.gemm", "type": "nvtx", "duration_ms": 10.05, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 10.05, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 10.05, "stream": 21}]}]}]}, {"name": "triton_poi_fused_mul_silu_0", "type": "kernel", "duration_ms": 0.64, "stream": 21}, {"name": "TERowParallelLinear forward", "type": "nvtx", "duration_ms": 10.443, "children": [{"name": "transformer_engine._Linear.forward.gemm", "type": "nvtx", "duration_ms": 5.016, "children": [{"name": "nvte_cublas_gemm", "type": "nvtx", "duration_ms": 5.016, "children": [{"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 5.016, "stream": 21}]}]}, {"name": "transformer_engine._Linear.forward.row_parallel_comm", "type": "nvtx", "duration_ms": 5.424, "children": [{"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.424, "stream": 56}]}]}]}, {"name": "TransformerLayer._forward_mlp.mlp_bda", "type": "nvtx", "duration_ms": 0.186, "children": [{"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.186, "stream": 21}]}, {"name": "nvte_rmsnorm_fwd", "type": "nvtx", "duration_ms": 0.141, "children": [{"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.141, "stream": 21}]}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.428, "stream": 56}, {"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 45.605, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.051, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.053, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.052, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.052, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.052, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.053, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.054, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.052, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.987, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.987, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.988, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.988, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.985, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.986, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.989, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.987, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.988, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.987, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.988, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.988, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.987, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.986, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.988, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.987, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.496, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.488, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.487, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.487, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.489, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.488, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.487, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.487, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.031, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.024, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.024, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.025, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.025, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.021, "stream": 21}, {"name": "cleanup", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "ncclDevKernel_AllReduce_Sum_f32_TREE_LL", "type": "kernel", "duration_ms": 0.298, "stream": 60}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.042, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.046, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.047, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.046, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.047, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.037, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.004, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.003, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.012, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.027, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.021, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.018, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.057, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.04, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.005, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.011, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.009, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.004, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.01, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.007, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.003, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.011, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.027, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.021, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.018, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.058, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.039, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.003, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.005, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.012, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.009, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.004, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.01, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.007, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.079, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.247, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.13, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "ncclDevKernel_AllReduce_Sum_f32_TREE_LL", "type": "kernel", "duration_ms": 1.0, "stream": 60}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.167, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.174, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.176, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.172, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.174, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.122, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.006, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.014, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.023, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.007, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.005, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.012, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.023, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.007, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.005, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.092, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.764, "stream": 52}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "indexSelectLargeIndex", "type": "kernel", "duration_ms": 6.478, "stream": 21}, {"name": "elementwise_kernel", "type": "kernel", "duration_ms": 2.521, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 6.121, "stream": 56}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "elementwise_kernel_with_index", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.013, "stream": 21}, {"name": "CatArrayBatchedCopy_aligned16_contig", "type": "kernel", "duration_ms": 0.015, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.137, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 6.462, "stream": 56}, {"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 2.146, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.337, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.159, "stream": 21}, {"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.08, "stream": 21}, {"name": "flash_fwd_kernel", "type": "kernel", "duration_ms": 26.028, "stream": 21}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 1.673, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.455, "stream": 56}, {"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.185, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.136, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.4, "stream": 56}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 10.05, "stream": 21}, {"name": "triton_poi_fused_mul_silu_0", "type": "kernel", "duration_ms": 0.637, "stream": 21}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 5.011, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.433, "stream": 56}, {"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.185, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.139, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.443, "stream": 56}, {"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 2.169, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.387, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.186, "stream": 21}, {"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.085, "stream": 21}, {"name": "flash_fwd_kernel", "type": "kernel", "duration_ms": 28.801, "stream": 21}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 1.68, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.32, "stream": 56}, {"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.185, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.142, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.353, "stream": 56}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 10.044, "stream": 21}, {"name": "triton_poi_fused_mul_silu_0", "type": "kernel", "duration_ms": 0.642, "stream": 21}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 5.013, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.487, "stream": 56}, {"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.185, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.139, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.447, "stream": 56}, {"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 2.157, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.349, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.165, "stream": 21}, {"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.08, "stream": 21}, {"name": "flash_fwd_kernel", "type": "kernel", "duration_ms": 26.852, "stream": 21}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 1.669, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 7.89, "stream": 56}, {"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.186, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.143, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.419, "stream": 56}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 10.046, "stream": 21}, {"name": "triton_poi_fused_mul_silu_0", "type": "kernel", "duration_ms": 0.641, "stream": 21}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 5.018, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.459, "stream": 56}, {"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.185, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.141, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.419, "stream": 56}, {"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 2.16, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.36, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.171, "stream": 21}, {"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.082, "stream": 21}, {"name": "flash_fwd_kernel", "type": "kernel", "duration_ms": 27.103, "stream": 21}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 1.673, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 7.37, "stream": 56}, {"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.186, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.14, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.437, "stream": 56}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 10.043, "stream": 21}, {"name": "triton_poi_fused_mul_silu_0", "type": "kernel", "duration_ms": 0.642, "stream": 21}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 5.012, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.413, "stream": 56}, {"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.186, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.139, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.488, "stream": 56}, {"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 45.729, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.106, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.108, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.108, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.108, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.091, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.078, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.076, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.076, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.988, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.989, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.987, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.988, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.988, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.986, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.985, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.988, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.986, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.986, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.986, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.987, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.986, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.982, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.986, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.986, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.495, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.488, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.488, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.488, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.488, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.487, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.489, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.489, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.031, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.024, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.025, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.024, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.024, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.021, "stream": 21}, {"name": "cleanup", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "ncclDevKernel_AllReduce_Sum_f32_TREE_LL", "type": "kernel", "duration_ms": 0.309, "stream": 60}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.042, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.046, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.048, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.046, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.047, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.037, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.004, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.003, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.012, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.028, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.021, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.018, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.058, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.039, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.005, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.012, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.009, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.004, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.01, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.007, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.011, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.026, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.022, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.018, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.057, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.039, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.005, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.011, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.009, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.004, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.01, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.008, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.079, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.246, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.129, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "ncclDevKernel_AllReduce_Sum_f32_TREE_LL", "type": "kernel", "duration_ms": 1.184, "stream": 60}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.168, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.178, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.174, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.179, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.175, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.123, "stream": 21}, {"name": "multi_tensor_apply_kernel", "type": "kernel", "duration_ms": 0.006, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.013, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.023, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.008, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.005, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.012, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.022, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.007, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.005, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.091, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 6.005, "stream": 52}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.003, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "indexSelectLargeIndex", "type": "kernel", "duration_ms": 6.497, "stream": 21}, {"name": "elementwise_kernel", "type": "kernel", "duration_ms": 2.521, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 6.244, "stream": 56}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "elementwise_kernel_with_index", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.013, "stream": 21}, {"name": "CatArrayBatchedCopy_aligned16_contig", "type": "kernel", "duration_ms": 0.015, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.148, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.317, "stream": 56}, {"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 2.153, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.338, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.159, "stream": 21}, {"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.08, "stream": 21}, {"name": "flash_fwd_kernel", "type": "kernel", "duration_ms": 26.006, "stream": 21}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 1.67, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.347, "stream": 56}, {"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.186, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.134, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.378, "stream": 56}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 10.053, "stream": 21}, {"name": "triton_poi_fused_mul_silu_0", "type": "kernel", "duration_ms": 0.641, "stream": 21}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 5.02, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.453, "stream": 56}, {"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.186, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.138, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.431, "stream": 56}, {"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 2.16, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.353, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.168, "stream": 21}, {"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.081, "stream": 21}, {"name": "flash_fwd_kernel", "type": "kernel", "duration_ms": 27.124, "stream": 21}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 1.671, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 7.525, "stream": 56}, {"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.184, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.144, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.425, "stream": 56}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 10.064, "stream": 21}, {"name": "triton_poi_fused_mul_silu_0", "type": "kernel", "duration_ms": 0.639, "stream": 21}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 5.02, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.449, "stream": 56}, {"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.186, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.138, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.501, "stream": 56}, {"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 2.164, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.366, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.19, "stream": 21}, {"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.086, "stream": 21}, {"name": "flash_fwd_kernel", "type": "kernel", "duration_ms": 28.735, "stream": 21}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 1.679, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.638, "stream": 56}, {"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.185, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.137, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.402, "stream": 56}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 10.075, "stream": 21}, {"name": "triton_poi_fused_mul_silu_0", "type": "kernel", "duration_ms": 0.64, "stream": 21}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 5.017, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.441, "stream": 56}, {"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.185, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.141, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.434, "stream": 56}, {"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 2.173, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.386, "stream": 21}, {"name": "fused_rope_thd_forward", "type": "kernel", "duration_ms": 1.184, "stream": 21}, {"name": "elementwise_kernel", "type": "kernel", "duration_ms": 0.084, "stream": 21}, {"name": "flash_fwd_kernel", "type": "kernel", "duration_ms": 28.74, "stream": 21}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 1.678, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.346, "stream": 56}, {"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.186, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.139, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.366, "stream": 56}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 10.059, "stream": 21}, {"name": "triton_poi_fused_mul_silu_0", "type": "kernel", "duration_ms": 0.64, "stream": 21}, {"name": "nvjet_tst_128x320_64x3_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 5.018, "stream": 21}, {"name": "ncclDevKernel_ReduceScatter_Sum_bf16_RING_LL", "type": "kernel", "duration_ms": 5.396, "stream": 56}, {"name": "triton_poi_fused_add_0", "type": "kernel", "duration_ms": 0.185, "stream": 21}, {"name": "rmsnorm_fwd_tuned_kernel", "type": "kernel", "duration_ms": 0.137, "stream": 21}, {"name": "ncclDevKernel_AllGather_RING_LL", "type": "kernel", "duration_ms": 5.423, "stream": 56}, {"name": "nvjet_tst_192x192_64x4_2x1_v_bz_coopB_TNN", "type": "kernel", "duration_ms": 45.404, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.139, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.139, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.138, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.14, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.14, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.14, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.139, "stream": 21}, {"name": "unrolled_elementwise_kernel", "type": "kernel", "duration_ms": 2.139, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.987, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.989, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.987, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.987, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.988, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.987, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.986, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.985, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.986, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.985, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.987, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.986, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.985, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.985, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.985, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.987, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.493, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.488, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.483, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.485, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.485, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.486, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.486, "stream": 21}, {"name": "reduce_kernel", "type": "kernel", "duration_ms": 0.486, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.002, "stream": 21}, {"name": "vectorized_elementwise_kernel", "type": "kernel", "duration_ms": 0.001, "stream": 21}]}];

function countNodes(nodes) {
  let nvtx = 0, kern = 0, totalMs = 0;
  function walk(n) {
    if (n.type === 'kernel') { kern++; totalMs += n.duration_ms; }
    else { nvtx++; }
    (n.children || []).forEach(walk);
  }
  nodes.forEach(walk);
  return { nvtx, kern, totalMs };
}

function renderNode(node, depth) {
  const hasChildren = node.children && node.children.length > 0;
  const isKernel = node.type === 'kernel';
  const cls = isKernel ? 'kernel' : 'nvtx';
  const icon = isKernel ? '⚡' : '📦';
  const toggle = hasChildren ? '▶' : ' ';
  const stream = node.stream !== undefined ? '<span class="stream">[stream ' + node.stream + ']</span>' : '';
  const dur = '<span class="dur">' + node.duration_ms.toFixed(3) + 'ms</span>';

  let html = '<div class="node ' + cls + '" data-depth="' + depth + '">';
  html += '<div class="node-header" onclick="toggleNode(this)">';
  html += '<span class="toggle">' + toggle + '</span>';
  html += '<span class="icon">' + icon + '</span>';
  html += '<span class="name">' + escHtml(node.name) + '</span>';
  html += stream + dur;
  html += '</div>';

  if (hasChildren) {
    html += '<div class="children' + (depth > 1 ? ' collapsed' : '') + '">';
    node.children.forEach(c => html += renderNode(c, depth + 1));
    html += '</div>';
  }
  html += '</div>';
  return html;
}

function escHtml(s) {
  return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

function toggleNode(header) {
  const children = header.nextElementSibling;
  if (!children || !children.classList.contains('children')) return;
  children.classList.toggle('collapsed');
  const toggle = header.querySelector('.toggle');
  toggle.textContent = children.classList.contains('collapsed') ? '▶' : '▼';
}

function expandAll() {
  document.querySelectorAll('.children').forEach(c => {
    c.classList.remove('collapsed');
    c.previousElementSibling.querySelector('.toggle').textContent = '▼';
  });
}

function collapseAll() {
  document.querySelectorAll('.children').forEach(c => {
    c.classList.add('collapsed');
    c.previousElementSibling.querySelector('.toggle').textContent = '▶';
  });
}

function expandToDepth(maxDepth) {
  document.querySelectorAll('.node').forEach(n => {
    const d = parseInt(n.dataset.depth);
    const children = n.querySelector(':scope > .children');
    if (!children) return;
    const toggle = n.querySelector(':scope > .node-header .toggle');
    if (d < maxDepth) {
      children.classList.remove('collapsed');
      toggle.textContent = '▼';
    } else {
      children.classList.add('collapsed');
      toggle.textContent = '▶';
    }
  });
}

function filterTree(query) {
  const q = query.toLowerCase();
  document.querySelectorAll('.node').forEach(n => {
    const name = n.querySelector(':scope > .node-header .name');
    if (!q) {
      n.style.display = '';
      name.innerHTML = escHtml(name.textContent);
      return;
    }
    const text = name.textContent;
    const idx = text.toLowerCase().indexOf(q);
    if (idx >= 0) {
      n.style.display = '';
      name.innerHTML = escHtml(text.slice(0, idx)) +
        '<span class="highlight">' + escHtml(text.slice(idx, idx + q.length)) + '</span>' +
        escHtml(text.slice(idx + q.length));
      // Expand parents
      let p = n.parentElement;
      while (p && p.classList.contains('children')) {
        p.classList.remove('collapsed');
        p.previousElementSibling.querySelector('.toggle').textContent = '▼';
        p = p.parentElement?.parentElement;
      }
    } else {
      // Don't hide if any child matches
      const hasMatch = n.querySelector('.name') &&
        [...n.querySelectorAll('.name')].some(nm => nm.textContent.toLowerCase().includes(q));
      n.style.display = hasMatch ? '' : 'none';
      name.innerHTML = escHtml(text);
    }
  });
}

// Render
const stats = countNodes(DATA);
document.getElementById('stats').innerHTML =
  '<span>NVTX: <strong>' + stats.nvtx + '</strong></span>' +
  '<span>Kernels: <strong>' + stats.kern + '</strong></span>' +
  '<span>Total GPU: <strong>' + stats.totalMs.toFixed(1) + 'ms</strong></span>';

let html = '';
DATA.forEach(n => html += renderNode(n, 0));
document.getElementById('tree').innerHTML = html;
</script>
</body>
</html>